{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="heroContainer">
    <img id="image1" src="{% static '/images/cart.jpg' %}" alt="cart image">
    <img id="image2" src="{% static '/images/veges.jpg' %}" alt="vegetables image">
    <div class="slogan">Your Personal Grocery Genie.</div>
    <a id="shopnow" href="#shop">Shop Now</a>
</div>

{% if recommended_products %}
<section id="recommended" class="px-2 py-6">
    <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 text-center mb-4">Recommended for You</h2>
    <div id="recommend-container" class="grid grid-cols-2 lg:grid-cols-4 gap-1">
        {% for product in recommended_products %}
        <div id="cards" class="bg-white shadow-md rounded-lg p-3 hover:shadow-xl transition">
            <img id="card-image" src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-36 object-cover rounded-md">
            <h4 id="card-name" class="text-base font-semibold mt-2">{{ product.name }}</h4>
            <p id="card-desc" class="text-sm text-gray-600 mt-1">{{ product.description|truncatechars:50 }}</p>
            <p id="card-price" class="text-sm font-bold text-gray-600 mt-2">Rs <strike>{{ product.market_price }}</strike> &nbsp; <mark>{{ product.selling_price }}</mark></p>
            <a id="card-button" href="{% url 'product_detail' product.id %}" class="mt-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition inline-block">
                View Details
            </a>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}


{% if recently_visited %}
<section id="recently" class="px-2 py-6">
    <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 text-center mb-4">Recently Viewed Groceries</h2>
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-1">
        {% for product in recently_visited %}
        <div class="bg-white shadow-md rounded-lg p-3 hover:shadow-xl transition">
            <img src="{{ product.product.image.url }}" alt="{{ product.product.name }}" class="w-full h-36 object-cover rounded-md">
            <h4 class="text-base font-semibold mt-2">{{ product.product.name }}</h4>
            <p class="text-sm text-gray-600 mt-1">{{ product.product.description|truncatechars:50 }}</p>
            <p class="text-sm font-bold text-gray-600 mt-2">
                Rs <strike>{{ product.product.market_price }}</strike> &nbsp;
                <mark>{{ product.product.selling_price }}</mark>
            </p>
            <a href="{% url 'product_detail' product.product.id %}" class="mt-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition inline-block">
                View Details
            </a>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}


<section id="categories" class="py-8">
    <div class="container mx-auto text-center">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Categories</h2>
        <div class="flex flex-wrap justify-center space-x-4 space-y-2 space">
            <button class="category-btn active" data-category="all">All</button>
            <button class="category-btn" data-category="fruits">Fruits</button>
            <button class="category-btn" data-category="vegetables">Vegetables</button>
            <button class="category-btn" data-category="dairy">Dairy</button>
            <button class="category-btn" data-category="beverages">Beverages</button>
            <button class="category-btn" data-category="snacks">Snacks</button>
        </div>
    </div>
</section>

<section id="shop" class="py-8">
    <div class="container mx-auto">
        <h2 id="featured" class="text-2xl font-bold text-gray-800 mb-6 leading-10 text-center">Featured Products</h2>
        <div id="product-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4  sm:gap-6 sm:px-0">
            {% for product in featured_products %}
            <div class="bg-white shadow-md rounded-lg p-3 sm:p-4 hover:shadow-xl transition">
                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-36 sm:h-40 object-cover rounded-md">
                <a href="{% url 'product_detail' product.id %}">
                <h4 class="text-sm sm:text-lg text-black font-semibold mt-2">{{ product.name }}</h4>
            </a>
                <h4 class="text-sm sm:text-lg text-blue-600 font-semibold">{{ product.discount_percent }} % Off</h4>
                <p id="description" class="text-xs sm:text-sm text-gray-600 mt-1">{{ product.description|truncatechars:50 }}</p>
                <p class="text-sm sm:text-md font-bold text-gray-600 mt-2">
                    Rs <strike>{{ product.market_price }}</strike> &nbsp;
                    <mark>{{ product.selling_price }}</mark>
                </p>
                {% if user.is_authenticated %}
                <a id="featured-view-button" href="{% url 'product_detail' product.id %}" class="mt-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 transition inline-block">
                    View Details
                </a>
                {% else %}
                <a id="featured-view-button" href="{% url 'login' %}" class="mt-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 transition inline-block">
                    View Details
                </a>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
</section>


<script>
    $(document).ready(function() {
        $('.category-btn').click(function() {
            $('.category-btn').removeClass('active');
            $(this).addClass('active');
            var category = $(this).data('category');
            $.ajax({
                url: '{% url "filter_products" %}',
                data: {
                    'category': category
                },
                success: function(data) {
                    $('#product-grid').html(data);
                }
            });
        });
    });
</script>

    <script>
        $(document).ready(function() {
            $('.category-btn').click(function() {
                var category = $(this).data('category');
                $.ajax({
                    url: '{% url "filter_products" %}',
                    data: {
                        'category': category
                    },
                    success: function(data) {
                        $('#product-grid').html(data);
                    }
                });
            });
        });
    </script>

{% endblock %}
